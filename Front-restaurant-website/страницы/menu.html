<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–µ–Ω—é —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞</title>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
    <link rel="icon" href="/authorization/img/web-icon.png">
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/menu.css">
</head>

<body>
    <header></header>

    <main>
        <h2>–ù–∞—à–µ –º–µ–Ω—é</h2>
        <div class="tabs">
            <!-- –ö–Ω–æ–ø–∫–∏ –≤–∫–ª–∞–¥–æ–∫ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ JavaScript -->
        </div>
        <div id="menu-items"></div> <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–ª—é–¥ -->

        <h2 id="my-basket">–ö–æ—Ä–∑–∏–Ω–∞</h2>
        <div id="cart">
            <div id="cart-items"></div> <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∫–æ—Ä–∑–∏–Ω—ã -->
            <div id="cart-total">–ò—Ç–æ–≥–æ: <span id="total-price">0</span> ‚ÇΩ</div>
            <button id="clear-cart" style="display: none;">üóë –û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É</button>
            <input type="text" id="table-number" placeholder="–ù–æ–º–µ—Ä —Å—Ç–æ–ª–∏–∫–∞" required>
            <textarea id="order-notes" placeholder="–í–∞—à–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è –∫ –∑–∞–∫–∞–∑—É"></textarea>
            <button id="place-order">–°–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑</button>
        </div>
    </main>

    <footer>
        <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω footer.html -->
    </footer>

 

    <script>
        function parseJwt(token) {
    const base64Url = token.split('.')[1]; // payload
    const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
 
    const jsonPayload = decodeURIComponent(
        atob(base64)
            .split('')
            .map(c => '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2))
            .join('')
    );
 
    return JSON.parse(jsonPayload);
}
 fetch('/—Å—Ç—Ä–∞–Ω–∏—Ü—ã/header.html')
    .then(response => response.text())
    .then(data => {
        document.querySelector('header').innerHTML = data;
        let a = document.getElementById("url-auth");
        let token = localStorage.getItem("token");
        if(token){
            let payload = parseJwt(token);
         //   console.log(payload);
            if(payload){
                a.href= "/—Å—Ç—Ä–∞–Ω–∏—Ü—ã/profile.html";
              a.firstElementChild.src='/authorization/img/avatar-icon.png';
            } 
        }else{ //–∏–∑–º–µ–Ω–∏—Ç—å!
            a.href= "/authorization/auth.html";
            a.firstElementChild.src='/authorization/img/auth.png';
        }
    })
    .catch(err => {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ header:', err);
    });

fetch('/—Å—Ç—Ä–∞–Ω–∏—Ü—ã/footer.html')
    .then(response => response.text())
    .then(data => {
        document.querySelector('footer').innerHTML = data;
    })
    .catch(err => {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ footer:', err);
    });
    // =================================
    document.addEventListener('DOMContentLoaded', () => {
    const links = document.querySelectorAll('.nav-link');
    const highlight = document.querySelector('.highlight');
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–≤–∏–∂–µ–Ω–∏—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏
    function moveHighlight(link) {
        highlight.style.width = link.offsetWidth + 'px';
        highlight.style.left = link.offsetLeft + 'px';
    }
    
    // –°–ª—É—à–∞—Ç–µ–ª–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –≤–∫–ª–∞–¥–æ–∫
    links.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();

            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å –≤—Å–µ—Ö —Å—Å—ã–ª–æ–∫
            links.forEach(l => l.classList.remove('active'));

            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ —Ç–µ–∫—É—â–µ–π –≤–∫–ª–∞–¥–∫–µ
            link.classList.add('active');

            // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É
            moveHighlight(link);
        });
    });

    // –ò–∑–Ω–∞—á–∞–ª—å–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Å–≤–µ—Ç–∫–∏ –¥–ª—è –ø–µ—Ä–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏
    const active = document.querySelector('.nav-link.active');
    if (active) {
        moveHighlight(active);
    }
});

fetch('/—Å—Ç—Ä–∞–Ω–∏—Ü—ã/header.html')
        .then(response => response.text())
        .then(data => {
            document.querySelector('header').innerHTML = data;
            let a = document.getElementById("url-auth");
            let token = localStorage.getItem("token");
            if(token){
                let payload = parseJwt(token);
              //  console.log(payload);
                if(payload){
                    a.href= "/—Å—Ç—Ä–∞–Ω–∏—Ü—ã/profile.html";
                    a.firstElementChild.src='/authorization/img/avatar-icon.png';
                } 
            }else{
                a.href= "/authorization/auth.html";
                a.firstElementChild.src='/authorization/img/auth.png';
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –±—É—Ä–≥–µ—Ä-–º–µ–Ω—é –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ header
            initBurgerMenu();
        })
        .catch(err => {
            console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ header:', err);
        });
        function initBurgerMenu() {
        const burgerMenu = document.querySelector('.burger-menu');
        if (burgerMenu) {
            burgerMenu.addEventListener('click', function() {
                const nav = document.querySelector('nav');
                burgerMenu.classList.toggle('active');
                if (nav) {
                    nav.classList.toggle('active');
                }
            });
        }
    }
// document.querySelector('.burger-menu').addEventListener('click', function() {
//     const nav = document.querySelector('nav');
//     const burgerMenu = document.querySelector('.burger-menu');
//     nav.classList.toggle('active');
//     burgerMenu.classList.toggle('active');
// });

    </script>


<script src="/js/menu.js"></script> <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ JS —Ñ–∞–π–ª–∞ -->
    <script src="/router-check.js"></script>

</body>

</html>
